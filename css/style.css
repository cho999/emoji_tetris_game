:root{
  --box-w: 360px; /* 落下ボックス幅 */
  --box-h: 540px; /* 落下ボックス高さ */
  --cols: 10;      /* 列数（石の積み上げ管理）*/
  --cell: calc(var(--box-w) / var(--cols));
  --ui-gap: 14px;
  --emoji-size: 36px; /* 落下絵文字サイズ */
  --target-font: 28px; /* 語彙バーのフォントサイズ */
}
* { box-sizing: border-box; }
body{ font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans JP", Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji"; margin:0; background:#0b0d12; color:#e8edf6; }
.wrap{ display:flex; justify-content:center; padding:16px; gap:var(--ui-gap); flex-wrap:wrap; }

/* 左：ゲーム領域 */
.stage-wrap{ display:flex; flex-direction:column; align-items:center; gap:var(--ui-gap); }
.stage{
  position:relative; width:var(--box-w); height:var(--box-h);
  background:linear-gradient(180deg,#121625,#0b0d12);
  border:2px solid #2a3357; border-radius:12px; overflow:hidden;
  box-shadow:0 6px 24px rgba(0,0,0,.35), inset 0 0 0 1px rgba(255,255,255,.03);
}
.stage::after{
  content:""; position:absolute; inset:0; background:
    linear-gradient(to right, rgba(255,255,255,.05) 1px, transparent 1px),
    linear-gradient(to bottom, rgba(255,255,255,.04) 1px, transparent 1px);
  background-size: var(--cell) var(--cell), var(--cell) var(--cell);
  pointer-events:none;
}

.emoji{ position:absolute; font-size:var(--emoji-size); line-height:1; cursor:pointer; user-select:none; }
.stone{ position:absolute; width:var(--cell); height:var(--cell); display:grid; place-items:center; font-size:28px; }
.stone::before{ content:"🪨"; filter: saturate(0.7) brightness(0.9); }

/* コンボ+5のフラッシュ */
.flash{ position:absolute; left:50%; top:12px; transform:translateX(-50%); font-weight:700; color:#ff4d5a; text-shadow:0 2px 0 #000; opacity:0; transition:opacity .2s; }
.flash.show{ opacity:1; animation: pop .9s ease-out forwards; }
@keyframes pop{ 0%{ transform:translate(-50%,0) scale(.8); } 25%{ transform:translate(-50%,-8px) scale(1.05);} 100%{ transform:translate(-50%,-20px) scale(1); opacity:0; } }

/* 下：語彙バー */
.targetbar{
  width:var(--box-w);
  background:#10182b; border:2px solid #2a3357; border-radius:12px; padding:10px 14px;
  display:flex; align-items:center; justify-content:center; gap:8px;
  box-shadow:0 6px 24px rgba(0,0,0,.25), inset 0 0 0 1px rgba(255,255,255,.03);
  min-height:62px;
}
.target-label{ font-size:14px; opacity:.7; }
.target-word{ font-size:var(--target-font); font-weight:700; letter-spacing:.04em; }

/* 右：スコア＆ミス一覧 */
.side{
  width:280px; min-height: calc(var(--box-h) + 62px + var(--ui-gap));
  display:flex; flex-direction:column; gap:var(--ui-gap);
}
.panel{ background:#10182b; border:2px solid #2a3357; border-radius:12px; padding:12px; box-shadow:0 6px 24px rgba(0,0,0,.25), inset 0 0 0 1px rgba(255,255,255,.03); }
.score{ font-size:28px; font-weight:800; }
.sub{ opacity:.7; font-size:12px; }
.combo{ font-weight:700; }
.miss-list{ display:flex; gap:8px; flex-wrap:wrap; align-items:center; }
.miss-pill{ background:#1b2237; border:1px solid #334170; padding:4px 8px; border-radius:999px; display:flex; align-items:center; gap:6px; }
.miss-pill .x{ color:#ff6f7a; font-weight:900; }

/* スタート/ポーズ */
.toolbar{ display:flex; gap:8px; }
button{
  background:#243055; color:#e8edf6; border:1px solid #37509a; border-radius:10px; padding:10px 14px; font-weight:700; cursor:pointer;
  box-shadow:0 2px 0 #0a0f21; transition: transform .05s;
}
button:active{ transform: translateY(1px); }
button.secondary{ background:#17203a; border-color:#2a396b; font-weight:600; }

/* バナー（Game Clear/Over） */
.banner{
  position:absolute; left:50%; top:50%; transform:translate(-50%,-50%);
  background:#0f1426; border:2px solid #334170; border-radius:14px;
  padding:18px 20px; box-shadow:0 10px 40px rgba(0,0,0,.5);
  text-align:center;
}
.b-title{ font-size:22px; font-weight:800; margin-bottom:6px; }
.b-title.go{ color:#ff6f7a; }
.b-sub{ opacity:.85; margin-bottom:12px; }

/* モバイル最適化 */
@media (max-width: 860px){
  :root{ --box-w: 320px; --box-h: 480px; --emoji-size: 34px; --target-font: 24px; }
  .side{ width: 92vw; min-height:auto; order:3; }
  .stage-wrap{ order:1; }
}
.banner {
  position: absolute;
  left: 50%;
  top: 40%;
  transform: translate(-50%, -50%);
  background: #111a33;
  border: 2px solid #4c66d4;
  border-radius: 14px;
  padding: 20px 30px;
  text-align: center;
  color: #e8edf6;
  z-index: 20;
}
.banner .b-title {
  font-size: 26px;
  font-weight: 900;
  margin-bottom: 8px;
}
.banner .b-sub {
  font-size: 14px;
  margin-bottom: 12px;
}
.banner button {
  background: #4c66d4;
  border: none;
  padding: 8px 16px;
  color: white;
  font-weight: bold;
  cursor: pointer;
  border-radius: 8px;
}

